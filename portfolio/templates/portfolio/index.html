{% extends 'commons/base.html' %}
{% load static %}
{% load portfolio_extras %}
{% load counsel_extras %}

{% block extend_head %}
<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.1.1/jquery.min.js"></script>
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>
<script src="{% static 'commons/assets/js/csrf.js' %}"></script>
<script>
  $(document).ready(function() {
    $('#submit').click(function() {
      $.ajax({
        'url': "{% url 'articles:comment' %}",
        'type': 'POST',
        'data': {
          csrfmiddlewaretoken: '{{ csrf_token }}',
          'article_id': '{{ article.id }}',
          'content': $("#content").val(),
        },
        'dataType': 'json',
        'success': function(response) {
          $('#close').click();
        }
      });
    });
  });
</script>
{% endblock extend_head %}


{% block content %}
<section id="profile">
  <h4>マイページ</h4>
  <span class="image fit"><img src="{% static 'commons/images/pic07.jpg' %}"></span>
  <strong>username: {{ user.username }}</strong>
  <p><a href="{% url 'logout' %}" class="button">ログアウトする</a></p>
</section>

<section id="questions">
  <h3>最近の質問</h3>
  {% for question in user|get_questions %}
  <section id="question{{ question.id }}">
    <hr>
    <a href="{% url 'counsel:detail' question.id %}"><h4>{{ question.title }}</h4></a>
    <p>{{ question.content }}</p>
    <p>(新着回答: {{ question|count_new_answers }}件)</p>
  </section>
  {% endfor %}
  <a href="#" class="button">過去の質問</a>
</section>
<section id="answers">
  <h3>最近の回答</h3>
  {% for answer in user|get_your_answers %}
  <section id="answer{{ answer.id }}">
    <hr>
    {% answer_portfolio_node answer %}
  </section>
  {% endfor %}
</section>
  <ul class="pagination">
    {% if page > 1 %}
  	<li><span class="button">Prev</span></li>
    {% endif %}
    <li><a href="#" class="button">Next</a></li>
  </ul>

  {% post_question_modal %}

{% endblock content %}
